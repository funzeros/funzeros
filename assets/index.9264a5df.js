import{E as S,m as F}from"./useEngin.9e3a5043.js";import"./pixi.js.dd61c7eb.js";import{h as O}from"./@pixi.dfabe1c3.js";import{d as b,a as f,o as T,K as A,a1 as j,a2 as g,Y as m,e as u,a3 as w,_ as i,f as t,F as U,I as x,v as P,x as c,N as B}from"./@vue.e4b79c09.js";import{l as D}from"./lodash.dfc5297e.js";import{b as N}from"./index.0a6f9e2d.js";import"./promise-polyfill.7a7f9c83.js";import"./object-assign.24e5ba39.js";import"./eventemitter3.3bac0dbd.js";import"./earcut.c8ee28d1.js";import"./resource-loader.da9c09a4.js";import"./parse-uri.68f12d7d.js";import"./mini-signals.509d95ee.js";import"./ismobilejs.5c6954b9.js";import"./url.1ae0c968.js";import"./element-plus.4d933211.js";import"./resize-observer-polyfill.8deb1e21.js";import"./normalize-wheel.232c6e0a.js";import"./mitt.f672539e.js";import"./dayjs.39cf2b70.js";import"./async-validator.1fa0d626.js";import"./@popperjs.20e5d135.js";import"./querystring.d83c7c26.js";import"./vuex.b95b093b.js";import"./axios.19415c93.js";import"./qs.b3565f98.js";import"./side-channel.e93026fc.js";import"./get-intrinsic.09b068ae.js";import"./has-symbols.d7d9af64.js";import"./function-bind.93ccd396.js";import"./has.4e889cdf.js";import"./call-bind.0ec8bfba.js";import"./object-inspect.17a6c876.js";import"./vue-router.8665769a.js";import"./md5.a528f825.js";import"./crypt.2f2b878b.js";import"./charenc.26816e87.js";import"./is-buffer.ff293ffb.js";import"./store.33a50f5f.js";import"./nprogress.629858ae.js";class q extends S{constructor(o){super(o);this.effectiveKey=["w","a","s","d"],this.keyPool=new Map,this.speed=10,this.players=new Map,this.update=n=>{this.move(n),this.refreshCamera()},this.controlKD=n=>{!this.effectiveKey.includes(n.key)||this.keyPool.set(n.key,!0)},this.controlKU=n=>{!this.effectiveKey.includes(n.key)||this.keyPool.delete(n.key)},this.stageAdd(this.mapContainer),o.appendChild(this.app.view),this.ticker=new O,this.ticker.autoStart=!0,this.ticker.minFPS=30,this.ticker.maxFPS=60,this.ticker.add(this.update),this.ticker.start()}move(o){this.keyPool.has("w")&&(this.roleP.y-=this.speed*o),this.keyPool.has("a")&&(this.roleP.x-=this.speed*o),this.keyPool.has("s")&&(this.roleP.y+=this.speed*o),this.keyPool.has("d")&&(this.roleP.x+=this.speed*o)}registeredControl(){document.body.addEventListener("keydown",this.controlKD),document.body.addEventListener("keyup",this.controlKU)}cancelledControl(){document.body.removeEventListener("keydown",this.controlKD),document.body.removeEventListener("keyup",this.controlKU)}}var C=b({props:{mapList:{type:Array,required:!0}},setup(e){const o=f();let n;return T(()=>{n=new q(o.value),n.renderMap(e.mapList),n.registeredControl()}),A(()=>{n?.cancelledControl()}),{mapWrapRef:o,...{refreshBlock(){n?.mapContainer.removeChildren(0,n?.mapContainer.children.length),n?.renderMap(e.mapList)}}}}}),Ne=`@charset "UTF-8";
/* \u6539\u53D8\u4E3B\u9898\u8272\u53D8\u91CF */
.map-wrap[data-v-cebdfc0a] {
  display: flex;
  justify-content: center;
  width: 100%;
  height: 100%;
}`;const z=w();j("data-v-cebdfc0a");const W={class:"map-wrap",ref:"mapWrapRef"};g();const J=z((e,o,n,a,h,y)=>(m(),u("div",W,null,512)));C.render=J,C.__scopeId="data-v-cebdfc0a";const Y={circle:"circle",rect:"rect",roundedRect:"roundedRect"};class E{constructor(){this.type="rect",this.x=0,this.y=0,this.width=0,this.height=0,this.radius=0,this.color=11184810}}var $=b({props:{mapList:{type:Array,required:!0}},emits:["addBlock","delBlock","updateBlock"],setup(e,o){const n=f(new E),a=f(0);return{color:f("#aaaaaa"),modelRef:n,mapBlockType:Y,index:a,...{handleCreate(){o.emit("addBlock",n.value)},handleUpdate(){o.emit("updateBlock",n.value,a.value)},handleChose(d){a.value=d,n.value=N(new E,e.mapList[d])},handleDel(d,r){o.emit("delBlock",d),r.preventDefault()},handleExport(){const d=new Blob([JSON.stringify({name:"\u5730\u56FE",list:D.exports.cloneDeep(e.mapList).reverse()})],{type:"application/json"}),r=document.createElement("a");r.download="map.json",r.href=URL.createObjectURL(d),r.click()},handleChangeColor(d){n.value.color=Number(`0x${d.substring(1)}`)}}}}}),qe=`@charset "UTF-8";
/* \u6539\u53D8\u4E3B\u9898\u8272\u53D8\u91CF */
.list[data-v-1c3e87d2] {
  white-space: nowrap;
  width: calc(100vw - 40px);
  overflow-x: scroll;
  padding-bottom: 10px;
}
.list .item[data-v-1c3e87d2] {
  display: inline-block;
  border: 1px solid #fff;
  padding: 5px;
  cursor: pointer;
}
.list .item[data-v-1c3e87d2]:not(:first-of-type) {
  margin-left: 10px;
}
.list .item[data-v-1c3e87d2]:hover {
  background-color: #333;
}`;const s=w();j("data-v-1c3e87d2");const G={class:"list g-basic-scroll"},H=B("\u521B\u5EFA"),Q=B("\u66F4\u65B0"),X=B("\u5BFC\u51FA");g();const Z=s((e,o,n,a,h,y)=>{const d=i("el-option"),r=i("el-select"),p=i("el-form-item"),v=i("el-input-number"),k=i("el-button"),V=i("el-col"),M=i("el-color-picker"),I=i("el-row"),K=i("el-form");return m(),u("div",null,[t("div",G,[(m(!0),u(U,null,x(e.mapList,(l,_)=>(m(),u("div",{class:"item",key:_,onClick:P(L=>e.handleChose(_),["left"]),onContextmenu:P(L=>e.handleDel(_,L),["right"])},[t("div",null,"type\uFF1A"+c(l.type),1),t("div",null,"x\uFF1A"+c(l.x),1),t("div",null,"y\uFF1A"+c(l.y),1),t("div",null,"width\uFF1A"+c(l.width),1),t("div",null,"height\uFF1A"+c(l.height),1),t("div",null,"radius\uFF1A"+c(l.radius),1),t("div",null,"color\uFF1A"+c(l.color),1)],40,["onClick","onContextmenu"]))),128))]),t(K,{model:e.modelRef,"label-width":"60px"},{default:s(()=>[t(I,null,{default:s(()=>[t(V,{span:12},{default:s(()=>[t(p,{label:"\u7C7B\u578B"},{default:s(()=>[t(r,{modelValue:e.modelRef.type,"onUpdate:modelValue":o[1]||(o[1]=l=>e.modelRef.type=l)},{default:s(()=>[(m(!0),u(U,null,x(Object.keys(e.mapBlockType),l=>(m(),u(d,{key:l,label:l,value:l},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(p,{label:"x"},{default:s(()=>[t(v,{modelValue:e.modelRef.x,"onUpdate:modelValue":o[2]||(o[2]=l=>e.modelRef.x=l)},null,8,["modelValue"])]),_:1}),t(p,{label:"y"},{default:s(()=>[t(v,{modelValue:e.modelRef.y,"onUpdate:modelValue":o[3]||(o[3]=l=>e.modelRef.y=l)},null,8,["modelValue"])]),_:1}),t(p,null,{default:s(()=>[t(k,{onClick:o[4]||(o[4]=l=>e.handleCreate())},{default:s(()=>[H]),_:1}),t(k,{onClick:o[5]||(o[5]=l=>e.handleUpdate())},{default:s(()=>[Q]),_:1}),t(k,{onClick:o[6]||(o[6]=l=>e.handleExport())},{default:s(()=>[X]),_:1})]),_:1})]),_:1}),t(V,{span:12},{default:s(()=>[t(p,{label:"width"},{default:s(()=>[t(v,{modelValue:e.modelRef.width,"onUpdate:modelValue":o[7]||(o[7]=l=>e.modelRef.width=l)},null,8,["modelValue"])]),_:1}),t(p,{label:"height"},{default:s(()=>[t(v,{modelValue:e.modelRef.height,"onUpdate:modelValue":o[8]||(o[8]=l=>e.modelRef.height=l)},null,8,["modelValue"])]),_:1}),t(p,{label:"color"},{default:s(()=>[t(v,{modelValue:e.modelRef.color,"onUpdate:modelValue":o[9]||(o[9]=l=>e.modelRef.color=l)},null,8,["modelValue"]),t("span",{style:{display:"inline-block",height:"100%",width:"80px",background:`#${e.modelRef.color.toString(16)}`}},c(e.modelRef.color.toString(16)),5)]),_:1}),t(p,{label:"color"},{default:s(()=>[t(M,{modelValue:e.color,"onUpdate:modelValue":o[10]||(o[10]=l=>e.color=l),onChange:e.handleChangeColor},null,8,["modelValue","onChange"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])])});$.render=Z,$.__scopeId="data-v-1c3e87d2";var R=b({components:{Map:C,Opt:$},setup(){const e=f(),o=f(D.exports.cloneDeep(F).reverse());return{mapList:o,mapRef:e,...{addBlock(a){o.value.unshift(a),e.value.refreshBlock()},delBlock(a){o.value.splice(a,1),e.value.refreshBlock()},updateBlock(a,h){o.value.splice(h,1,a),e.value.refreshBlock()}}}}}),ze=`@charset "UTF-8";
/* \u6539\u53D8\u4E3B\u9898\u8272\u53D8\u91CF */
.edit-main[data-v-555fd4d1] {
  width: 100%;
  height: 100%;
  display: flex;
  flex-direction: column;
}
.edit-main > div[data-v-555fd4d1] {
  padding: 20px;
}
.edit-main > div[data-v-555fd4d1]:first-of-type {
  flex: 1;
}`;const ee=w();j("data-v-555fd4d1");const oe={class:"edit-main"};g();const te=ee((e,o,n,a,h,y)=>{const d=i("Map"),r=i("Opt");return m(),u("div",oe,[t("div",null,[t(d,{mapList:e.mapList,ref:"mapRef"},null,8,["mapList"])]),t("div",null,[t(r,{mapList:e.mapList,onAddBlock:e.addBlock,onDelBlock:e.delBlock,onUpdateBlock:e.updateBlock},null,8,["mapList","onAddBlock","onDelBlock","onUpdateBlock"])])])});R.render=te,R.__scopeId="data-v-555fd4d1";export default R;
