import{E as F,t as U,m as O}from"./useEngin.5c8433ed.js";import"./pixi.js.dd61c7eb.js";import{h as T}from"./@pixi.dfabe1c3.js";import{d as b,a as f,o as A,K as N,a1 as j,a2 as g,Y as m,e as u,a3 as w,_ as i,f as t,F as x,I as P,v as D,x as c,N as C}from"./@vue.e4b79c09.js";import{l as E}from"./lodash.dfc5297e.js";import{b as q}from"./index.399cf2a1.js";import"./promise-polyfill.7a7f9c83.js";import"./object-assign.24e5ba39.js";import"./eventemitter3.3bac0dbd.js";import"./earcut.c8ee28d1.js";import"./resource-loader.da9c09a4.js";import"./parse-uri.68f12d7d.js";import"./mini-signals.509d95ee.js";import"./ismobilejs.5c6954b9.js";import"./url.1ae0c968.js";import"./element-plus.4d933211.js";import"./resize-observer-polyfill.8deb1e21.js";import"./normalize-wheel.232c6e0a.js";import"./mitt.f672539e.js";import"./dayjs.39cf2b70.js";import"./async-validator.1fa0d626.js";import"./@popperjs.20e5d135.js";import"./querystring.d83c7c26.js";import"./vuex.b95b093b.js";import"./axios.19415c93.js";import"./qs.b3565f98.js";import"./side-channel.e93026fc.js";import"./get-intrinsic.09b068ae.js";import"./has-symbols.d7d9af64.js";import"./function-bind.93ccd396.js";import"./has.4e889cdf.js";import"./call-bind.0ec8bfba.js";import"./object-inspect.17a6c876.js";import"./vue-router.8665769a.js";import"./store.33a50f5f.js";import"./md5.a528f825.js";import"./crypt.2f2b878b.js";import"./charenc.26816e87.js";import"./is-buffer.ff293ffb.js";import"./nprogress.629858ae.js";class z extends F{constructor(o){super(o);this.effectiveKey=["w","a","s","d"],this.keyPool=new Map,this.speed=10,this.players=new Map,this.update=n=>{this.move(n),this.refreshCamera()},this.controlKD=n=>{const s=U(n.key);!this.effectiveKey.includes(s)||this.keyPool.set(s,!0)},this.controlKU=n=>{const s=U(n.key);!this.effectiveKey.includes(s)||this.keyPool.delete(s)},this.stageAdd(this.mapContainer),o.appendChild(this.app.view),this.ticker=new T,this.ticker.autoStart=!0,this.ticker.minFPS=30,this.ticker.maxFPS=60,this.ticker.add(this.update),this.ticker.start()}move(o){this.keyPool.has("w")&&(this.roleP.y-=this.speed*o),this.keyPool.has("a")&&(this.roleP.x-=this.speed*o),this.keyPool.has("s")&&(this.roleP.y+=this.speed*o),this.keyPool.has("d")&&(this.roleP.x+=this.speed*o)}registeredControl(){document.body.addEventListener("keydown",this.controlKD),document.body.addEventListener("keyup",this.controlKU)}cancelledControl(){document.body.removeEventListener("keydown",this.controlKD),document.body.removeEventListener("keyup",this.controlKU)}}var B=b({props:{mapList:{type:Array,required:!0}},setup(e){const o=f();let n;return A(()=>{n=new z(o.value),n.renderMap(e.mapList),n.registeredControl()}),N(()=>{n?.cancelledControl()}),{mapWrapRef:o,...{refreshBlock(){n?.mapContainer.removeChildren(0,n?.mapContainer.children.length),n?.renderMap(e.mapList)}}}}}),qe=`@charset "UTF-8";
/* \u6539\u53D8\u4E3B\u9898\u8272\u53D8\u91CF */
.map-wrap[data-v-cebdfc0a] {
  display: flex;
  justify-content: center;
  width: 100%;
  height: 100%;
}`;const W=w();j("data-v-cebdfc0a");const J={class:"map-wrap",ref:"mapWrapRef"};g();const Y=W((e,o,n,s,h,y)=>(m(),u("div",J,null,512)));B.render=Y,B.__scopeId="data-v-cebdfc0a";const G={circle:"circle",rect:"rect",roundedRect:"roundedRect"};class M{constructor(){this.type="rect",this.x=0,this.y=0,this.width=0,this.height=0,this.radius=0,this.color=11184810}}var $=b({props:{mapList:{type:Array,required:!0}},emits:["addBlock","delBlock","updateBlock"],setup(e,o){const n=f(new M),s=f(0);return{color:f("#aaaaaa"),modelRef:n,mapBlockType:G,index:s,...{handleCreate(){o.emit("addBlock",n.value)},handleUpdate(){o.emit("updateBlock",n.value,s.value)},handleChose(d){s.value=d,n.value=q(new M,e.mapList[d])},handleDel(d,r){o.emit("delBlock",d),r.preventDefault()},handleExport(){const d=new Blob([JSON.stringify({name:"\u5730\u56FE",list:E.exports.cloneDeep(e.mapList).reverse()})],{type:"application/json"}),r=document.createElement("a");r.download="map.json",r.href=URL.createObjectURL(d),r.click()},handleChangeColor(d){n.value.color=Number(`0x${d.substring(1)}`)}}}}}),ze=`@charset "UTF-8";
/* \u6539\u53D8\u4E3B\u9898\u8272\u53D8\u91CF */
.list[data-v-1c3e87d2] {
  white-space: nowrap;
  width: calc(100vw - 40px);
  overflow-x: scroll;
  padding-bottom: 10px;
}
.list .item[data-v-1c3e87d2] {
  display: inline-block;
  border: 1px solid #fff;
  padding: 5px;
  cursor: pointer;
}
.list .item[data-v-1c3e87d2]:not(:first-of-type) {
  margin-left: 10px;
}
.list .item[data-v-1c3e87d2]:hover {
  background-color: #333;
}`;const a=w();j("data-v-1c3e87d2");const H={class:"list g-basic-scroll"},Q=C("\u521B\u5EFA"),X=C("\u66F4\u65B0"),Z=C("\u5BFC\u51FA");g();const ee=a((e,o,n,s,h,y)=>{const d=i("el-option"),r=i("el-select"),p=i("el-form-item"),v=i("el-input-number"),k=i("el-button"),L=i("el-col"),I=i("el-color-picker"),K=i("el-row"),S=i("el-form");return m(),u("div",null,[t("div",H,[(m(!0),u(x,null,P(e.mapList,(l,_)=>(m(),u("div",{class:"item",key:_,onClick:D(V=>e.handleChose(_),["left"]),onContextmenu:D(V=>e.handleDel(_,V),["right"])},[t("div",null,"type\uFF1A"+c(l.type),1),t("div",null,"x\uFF1A"+c(l.x),1),t("div",null,"y\uFF1A"+c(l.y),1),t("div",null,"width\uFF1A"+c(l.width),1),t("div",null,"height\uFF1A"+c(l.height),1),t("div",null,"radius\uFF1A"+c(l.radius),1),t("div",null,"color\uFF1A"+c(l.color),1)],40,["onClick","onContextmenu"]))),128))]),t(S,{model:e.modelRef,"label-width":"60px"},{default:a(()=>[t(K,null,{default:a(()=>[t(L,{span:12},{default:a(()=>[t(p,{label:"\u7C7B\u578B"},{default:a(()=>[t(r,{modelValue:e.modelRef.type,"onUpdate:modelValue":o[1]||(o[1]=l=>e.modelRef.type=l)},{default:a(()=>[(m(!0),u(x,null,P(Object.keys(e.mapBlockType),l=>(m(),u(d,{key:l,label:l,value:l},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(p,{label:"x"},{default:a(()=>[t(v,{modelValue:e.modelRef.x,"onUpdate:modelValue":o[2]||(o[2]=l=>e.modelRef.x=l)},null,8,["modelValue"])]),_:1}),t(p,{label:"y"},{default:a(()=>[t(v,{modelValue:e.modelRef.y,"onUpdate:modelValue":o[3]||(o[3]=l=>e.modelRef.y=l)},null,8,["modelValue"])]),_:1}),t(p,null,{default:a(()=>[t(k,{onClick:o[4]||(o[4]=l=>e.handleCreate())},{default:a(()=>[Q]),_:1}),t(k,{onClick:o[5]||(o[5]=l=>e.handleUpdate())},{default:a(()=>[X]),_:1}),t(k,{onClick:o[6]||(o[6]=l=>e.handleExport())},{default:a(()=>[Z]),_:1})]),_:1})]),_:1}),t(L,{span:12},{default:a(()=>[t(p,{label:"width"},{default:a(()=>[t(v,{modelValue:e.modelRef.width,"onUpdate:modelValue":o[7]||(o[7]=l=>e.modelRef.width=l)},null,8,["modelValue"])]),_:1}),t(p,{label:"height"},{default:a(()=>[t(v,{modelValue:e.modelRef.height,"onUpdate:modelValue":o[8]||(o[8]=l=>e.modelRef.height=l)},null,8,["modelValue"])]),_:1}),t(p,{label:"color"},{default:a(()=>[t(v,{modelValue:e.modelRef.color,"onUpdate:modelValue":o[9]||(o[9]=l=>e.modelRef.color=l)},null,8,["modelValue"]),t("span",{style:{display:"inline-block",height:"100%",width:"80px",background:`#${e.modelRef.color.toString(16)}`}},c(e.modelRef.color.toString(16)),5)]),_:1}),t(p,{label:"color"},{default:a(()=>[t(I,{modelValue:e.color,"onUpdate:modelValue":o[10]||(o[10]=l=>e.color=l),onChange:e.handleChangeColor},null,8,["modelValue","onChange"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])])});$.render=ee,$.__scopeId="data-v-1c3e87d2";var R=b({components:{Map:B,Opt:$},setup(){const e=f(),o=f(E.exports.cloneDeep(O).reverse());return{mapList:o,mapRef:e,...{addBlock(s){o.value.unshift(s),e.value.refreshBlock()},delBlock(s){o.value.splice(s,1),e.value.refreshBlock()},updateBlock(s,h){o.value.splice(h,1,s),e.value.refreshBlock()}}}}}),We=`@charset "UTF-8";
/* \u6539\u53D8\u4E3B\u9898\u8272\u53D8\u91CF */
.edit-main[data-v-555fd4d1] {
  width: 100%;
  height: 100%;
  display: flex;
  flex-direction: column;
}
.edit-main > div[data-v-555fd4d1] {
  padding: 20px;
}
.edit-main > div[data-v-555fd4d1]:first-of-type {
  flex: 1;
}`;const oe=w();j("data-v-555fd4d1");const te={class:"edit-main"};g();const le=oe((e,o,n,s,h,y)=>{const d=i("Map"),r=i("Opt");return m(),u("div",te,[t("div",null,[t(d,{mapList:e.mapList,ref:"mapRef"},null,8,["mapList"])]),t("div",null,[t(r,{mapList:e.mapList,onAddBlock:e.addBlock,onDelBlock:e.delBlock,onUpdateBlock:e.updateBlock},null,8,["mapList","onAddBlock","onDelBlock","onUpdateBlock"])])])});R.render=le,R.__scopeId="data-v-555fd4d1";export default R;
